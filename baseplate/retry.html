<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>baseplate.retry &mdash; Baseplate</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="top" title="Baseplate" href="../index.html" />
    <link rel="next" title="baseplate.thrift_pool" href="thrift_pool.html" />
    <link rel="prev" title="baseplate.metrics" href="metrics.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="baseplate-retry">
<h1>baseplate.retry<a class="headerlink" href="#baseplate-retry" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This module is a low-level helper, many client libraries have
protocol-aware retry logic built in. Check your library before using this.</p>
</div>
<span class="target" id="module-baseplate.retry"></span><p>Policies for retrying an operation safely.</p>
<dl class="class">
<dt id="baseplate.retry.RetryPolicy">
<em class="property">class </em><tt class="descclassname">baseplate.retry.</tt><tt class="descname">RetryPolicy</tt><a class="headerlink" href="#baseplate.retry.RetryPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>A policy for retrying operations.</p>
<p>Policies are meant to be used as an iterable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">time_remaining</span> <span class="ow">in</span> <span class="n">RetryPolicy</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">attempts</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">some_operation</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_remaining</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">except</span> <span class="n">SomeError</span><span class="p">:</span>
        <span class="k">pass</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">MaxRetriesError</span>
</pre></div>
</div>
<dl class="method">
<dt id="baseplate.retry.RetryPolicy.yield_attempts">
<tt class="descname">yield_attempts</tt><big>(</big><big>)</big><a class="headerlink" href="#baseplate.retry.RetryPolicy.yield_attempts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator which controls attempts.</p>
<p>On each iteration, the iterator will yield the number of seconds left
to retry, this should be used to set the timeout on the operation
being carried out. If there is no maximum time remaining,
<a class="reference external" href="https://docs.python.org/3.4/library/constants.html#None" title="(in Python v3.4)"><tt class="xref py py-data docutils literal"><span class="pre">None</span></tt></a> is yielded instead.</p>
<p>The iterable will raise <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#StopIteration" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">StopIteration</span></tt></a> once the operation
should not be retried any further.</p>
</dd></dl>

<dl class="method">
<dt id="baseplate.retry.RetryPolicy.__iter__">
<tt class="descname">__iter__</tt><big>(</big><big>)</big><a class="headerlink" href="#baseplate.retry.RetryPolicy.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience alias for <a class="reference internal" href="#baseplate.retry.RetryPolicy.yield_attempts" title="baseplate.retry.RetryPolicy.yield_attempts"><tt class="xref py py-meth docutils literal"><span class="pre">yield_attempts()</span></tt></a>.</p>
<p>This allows policies to be directly iterated over.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="baseplate.retry.RetryPolicy.new">
<em class="property">static </em><tt class="descname">new</tt><big>(</big><em>attempts=None</em>, <em>budget=None</em>, <em>backoff=None</em><big>)</big><a class="headerlink" href="#baseplate.retry.RetryPolicy.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new retry policy with the given constraints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>attempts</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; The maximum number of times the operation can be
attempted.</li>
<li><strong>budget</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) &#8211; The maximum amount of time, in seconds, that the
local service will wait for the operation to succeed.</li>
<li><strong>backoff</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) &#8211; The base amount of time, in seconds, for
exponential backoff between attempts. <tt class="docutils literal"><span class="pre">N</span></tt> in (<tt class="docutils literal"><span class="pre">N</span> <span class="pre">*</span>
<span class="pre">2**attempts</span></tt>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/baseplate.png" alt="Logo"/>
    
  </a>
</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/healthcheck.html">baseplate-healthcheck: Is your service alive?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/serve.html">baseplate-serve: The application server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/script.html">baseplate-script: Run backend scripts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core.html">baseplate.core: The guts of the diagnostics framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="context/index.html">baseplate.context: Integration with client libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration/index.html">baseplate.integration: Integration with application frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics/index.html">baseplate.diagnostics: Diagnostics observers</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">baseplate: General purpose helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">baseplate.config: Configuration parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="crypto.html">baseplate.crypto: Cryptographic Primitives</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">baseplate.events: Events for the data pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_queue.html">baseplate.message_queue: POSIX IPC Message Queues</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">baseplate.metrics: Counters and timers for statsd</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">baseplate.retry: Policies for retrying operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="thrift_pool.html">baseplate.thrift_pool: A Thrift client connection pool</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="metrics.html" title="previous chapter">baseplate.metrics</a></li>
      <li>Next: <a href="thrift_pool.html" title="next chapter">baseplate.thrift_pool</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
      
      <a href="../_sources/baseplate/retry.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>